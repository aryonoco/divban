analyse this codebase in comprehensive details. Get a full understanding of its functionality,  modules, patterns and principles used. 

I have recently adopted the Effect library in this codebase and am moving from a combination of Zod + hand rolled facilities to fully adopting Effect as I'm finding the Effect library is quite good and very much in line with my software development principles (my background is in OCaml. 

Obviously Effect is a big library so I'm adopting it gradually across my codebase, replacing Zod and other hand crafted FP-inspired facilities with it . 

Read @llms/effect.llms.headline.txt 

To find more about a topic, you can read the full effect docs at llms/effect.llms.full.txt (this file is too big to fit in your context so grep for the relevant sections and read that) 
----

Once you have all the information needed about the existing codebase and effect, tell me, what is the most logical part of Effect which I can adopt next which would provide the highest value to this codebase? 


----


I have previously been provided with the following analysis. Read the following report completely and in full. Analyse the relevant sections. 
I have already implemented 1. Direct Replacement for Your Manual Rollback Logic and now want to implement 
Phase 2: Refactor executeSetupSteps to Use Scoped Resources
Focus on 
Phase 2: Refactor executeSetupSteps to Use Scoped Resources
Provide me with a full plan to completely and fully replace my manual rollback logic with the relevant tools from Effect 

Your plan should be complete. Once the plan is fully executed, there should be no sign of the legacy code left. No compatibility bridges or shims or wrappers. It should be a complete and clean refactor. 

----


ensure the plan is exhaustive and idempotent. do not leave any decisions for later. Do the
  required investigation now and ensure the plan is deterministic and complete


----

Ensure the plan fully leverages all the relevant tools available in Effect

Read @llms/effect.llms.headline.txt 

To find out the details of something in Effect, read the relevant parts of llms/effect.llms.full.txt (this file is too big to fit in your context so grep/search for the relevant sections and read those) 


--- 
Ensure the plan, as much as is practical, aligns with a "functional core, imperative shell" philosophy and is uses idiomatic Effect patterns and is FP-aligned where practical and uses the features of the Effect library to achieve its goal where possible